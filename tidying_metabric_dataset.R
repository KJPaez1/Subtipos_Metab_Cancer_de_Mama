# TIDING METABRIC DATASET

## import clinical data
data_clinical_patient <- read.delim("~/Thesis/E.X.E/Data/main_data/METABRIC/data_clinical_patient.txt")
data_clinical_sample <- read.delim("~/Thesis/E.X.E/Data/main_data/METABRIC/data_clinical_sample.txt")

## get PATIENT-ID of tumor at stage 4
library("tidyverse")

stage_4_names = filter(data_clinical_sample, TUMOR_STAGE == 4)
View(stage_4_names)


## exlude treated tumor and claudin-low type
ntherapy = filter(data_clinical_patient, CHEMOTHERAPY == "NO", HORMONE_THERAPY == "NO", RADIO_THERAPY == "NO")
View(ntherapy)                  

ntherapy_noclaudinlow = filter(ntherapy, !(CLAUDIN_SUBTYPE == "claudin-low"))
View(stage4_inside_notherapy_noclaudin)

## find PATIENT-IDs at stage 4 in the notherapy_noclaudinlow subset of samples
stage4_inside_notherapy_noclaudin = filter(ntherapy_noclaudinlow, PATIENT_ID %in% stage_4_names$PATIENT_ID)
View(notherapy_noclaudinlow_nostage4)

## exclude tumor at stage 4 and get the final nontherapy_nocludinlow_nostage4 dataset
notherapy_noclaudinlow_nostage4 = filter(ntherapy_noclaudinlow, !(PATIENT_ID == "MB-0268" | PATIENT_ID == "MB-0283" | PATIENT_ID == "MB-0363")) 

## save file

write.table(notherapy_noclaudinlow_nostage4, "C:/Users/pkevi/Documents/Thesis/E.X.E/Scripts/tidy/exe.tidy/notherapy_noclaudinlow_nostage4.txt", sep = "\t")

View(notherapy_noclaudinlow_nostage4)





## selecting genes values from the big dataset

data_expression_median[, names(data_expression_median) %in% c('col1', 'col2', 'col3', 'col4')]

METABRIC_without_pam50_surv = data_expression_median[, names(data_expression_median) %in% c("Hugo_Symbol", "Entrez_Gene_Id", notherapy_noclaudinlow_nostage4$PATIENT_ID)]
View(METABRIC_without_pam50_surv)

write.table(METABRIC_without_pam50_surv, 
            "C:/Users/pkevi/Documents/Thesis/E.X.E/Scripts/tidy/exe.tidy/METABRIC_without_pam50_surv.txt",
            sep = "\t")

## Selecting survival and pam50 information

sample_ID = c("MB-0346",
              "MB-0292",
              "MB-0272",
              "MB-0221",
              "MB-0270",
              "MB-0317",
              "MB-0035",
              "MB-0361",
              "MB-0152",
              "MB-0148",
              "MB-0142",
              "MB-0880",
              "MB-0550",
              "MB-0314",
              "MB-0356",
              "MB-0232",
              "MB-0287",
              "MB-4708",
              "MB-4665",
              "MB-4691",
              "MB-4717",
              "MB-4770",
              "MB-5169",
              "MB-4796",
              "MB-4790",
              "MB-4800",
              "MB-4825",
              "MB-4814",
              "MB-4712",
              "MB-4672",
              "MB-4704",
              "MB-4661",
              "MB-4648",
              "MB-5324",
              "MB-4682",
              "MB-4871",
              "MB-4866",
              "MB-4858",
              "MB-4867",
              "MB-4894",
              "MB-4670",
              "MB-5049",
              "MB-4171",
              "MB-5053",
              "MB-5119",
              "MB-4735",
              "MB-4730",
              "MB-5084",
              "MB-4878",
              "MB-4937",
              "MB-4933",
              "MB-5221",
              "MB-5279",
              "MB-5351",
              "MB-5064",
              "MB-5059",
              "MB-4266",
              "MB-5331",
              "MB-4743",
              "MB-4778",
              "MB-4787",
              "MB-4992",
              "MB-5035",
              "MB-5393",
              "MB-5306",
              "MB-5490",
              "MB-5429",
              "MB-5489",
              "MB-4749",
              "MB-4809",
              "MB-5424",
              "MB-5206",
              "MB-5491",
              "MB-5290",
              "MB-5402",
              "MB-5292",
              "MB-5196",
              "MB-5634",
              "MB-4408",
              "MB-5511",
              "MB-5422",
              "MB-5184",
              "MB-5499",
              "MB-4120",
              "MB-4822",
              "MB-4791",
              "MB-4970",
              "MB-2711",
              "MB-3064",
              "MB-3351",
              "MB-3298",
              "MB-2749",
              "MB-2747",
              "MB-2750",
              "MB-2947",
              "MB-2933",
              "MB-3490",
              "MB-3300",
              "MB-2536",
              "MB-3171",
              "MB-3222",
              "MB-3711",
              "MB-2790",
              "MB-2977",
              "MB-2840",
              "MB-3007",
              "MB-3378",
              "MB-3121",
              "MB-2819",
              "MB-2797",
              "MB-3850",
              "MB-3854",
              "MB-4681",
              "MB-4015",
              "MB-2931",
              "MB-2927",
              "MB-2919",
              "MB-4722",
              "MB-4643",
              "MB-3088",
              "MB-3500",
              "MB-7186",
              "MB-7232",
              "MB-7231",
              "MB-3252",
              "MB-7055",
              "MB-3528",
              "MB-2990",
              "MB-2846",
              "MB-7150",
              "MB-4839",
              "MB-5563",
              "MB-5656",
              "MB-4697",
              "MB-4679",
              "MB-4692",
              "MB-4653",
              "MB-5275",
              "MB-6185",
              "MB-6359",
              "MB-6207",
              "MB-6318",
              "MB-6225",
              "MB-6019",
              "MB-6179",
              "MB-6105",
              "MB-6050",
              "MB-6169",
              "MB-5086",
              "MB-5150",
              "MB-4705",
              "MB-4882",
              "MB-5081",
              "MB-4897",
              "MB-4896",
              "MB-4987",
              "MB-4091",
              "MB-5174",
              "MB-5239",
              "MB-4853",
              "MB-4222",
              "MB-4212",
              "MB-4949",
              "MB-5098",
              "MB-5278",
              "MB-5470",
              "MB-5277",
              "MB-4046",
              "MB-4738",
              "MB-4782",
              "MB-4442",
              "MB-4630",
              "MB-6021",
              "MB-6154",
              "MB-6023",
              "MB-6152",
              "MB-6018",
              "MB-6068",
              "MB-6042",
              "MB-6077",
              "MB-5335",
              "MB-4139",
              "MB-4880",
              "MB-5054",
              "MB-5057",
              "MB-4098",
              "MB-6218",
              "MB-6271",
              "MB-6245",
              "MB-4343",
              "MB-4278",
              "MB-6049",
              "MB-6044",
              "MB-6016",
              "MB-6149",
              "MB-6131",
              "MB-6092",
              "MB-6075",
              "MB-6011",
              "MB-6211",
              "MB-6234",
              "MB-4234",
              "MB-4235",
              "MB-4333",
              "MB-4375",
              "MB-4802",
              "MB-5208",
              "MB-6150",
              "MB-6014",
              "MB-6012",
              "MB-6024",
              "MB-6060",
              "MB-6008",
              "MB-6178",
              "MB-6116",
              "MB-4417",
              "MB-4306",
              "MB-7241",
              "MB-6133",
              "MB-6026",
              "MB-6168",
              "MB-6101",
              "MB-6156",
              "MB-5280",
              "MB-6314",
              "MB-6358",
              "MB-6237",
              "MB-6183",
              "MB-6231",
              "MB-6229",
              "MB-5154",
              "MB-0615",
              "MB-0231",
              "MB-0318",
              "MB-6238",
              "MB-6286",
              "MB-6344",
              "MB-0342",
              "MB-5640",
              "MB-0230",
              "MB-0109",
              "MB-4010",
              "MB-0526",
              "MB-0582",
              "MB-0163",
              "MB-0350",
              "MB-0339",
              "MB-0264",
              "MB-0655",
              "MB-0877",
              "MB-0897",
              "MB-0522",
              "MB-0290",
              "MB-0228",
              "MB-0588",
              "MB-0193",
              "MB-3797",
              "MB-0308",
              "MB-5471"
)


survandpam50info = data_clinical_patient[data_clinical_patient$PATIENT_ID %in% sample_ID,]

View(survandpam50info)

write.table(survandpam50info, 
            "C:/Users/pkevi/Documents/Thesis/E.X.E/Scripts/tidy/exe.tidy/survandpam50info.txt",
            sep = "\t")

METABRIC_pam50_surv = METABRIC_without_pam50_surv[,c("Hugo_Symbol", "Entrez_Gene_Id", "MB.0035",
                               "MB.0109",
                               "MB.0142",
                               "MB.0148",
                               "MB.0152",
                               "MB.0163",
                               "MB.0193",
                               "MB.0221",
                               "MB.0228",
                               "MB.0230",
                               "MB.0231",
                               "MB.0232",
                               "MB.0264",
                               "MB.0270",
                               "MB.0272",
                               "MB.0287",
                               "MB.0290",
                               "MB.0292",
                               "MB.0308",
                               "MB.0314",
                               "MB.0317",
                               "MB.0318",
                               "MB.0339",
                               "MB.0342",
                               "MB.0346",
                               "MB.0350",
                               "MB.0356",
                               "MB.0361",
                               "MB.0522",
                               "MB.0526",
                               "MB.0550",
                               "MB.0582",
                               "MB.0588",
                               "MB.0615",
                               "MB.0655",
                               "MB.0877",
                               "MB.0880",
                               "MB.0897",
                               "MB.2536",
                               "MB.2711",
                               "MB.2747",
                               "MB.2749",
                               "MB.2750",
                               "MB.2790",
                               "MB.2797",
                               "MB.2819",
                               "MB.2840",
                               "MB.2846",
                               "MB.2919",
                               "MB.2927",
                               "MB.2931",
                               "MB.2933",
                               "MB.2947",
                               "MB.2977",
                               "MB.2990",
                               "MB.3007",
                               "MB.3064",
                               "MB.3088",
                               "MB.3121",
                               "MB.3171",
                               "MB.3222",
                               "MB.3252",
                               "MB.3298",
                               "MB.3300",
                               "MB.3351",
                               "MB.3378",
                               "MB.3490",
                               "MB.3500",
                               "MB.3528",
                               "MB.3711",
                               "MB.3797",
                               "MB.3850",
                               "MB.3854",
                               "MB.4010",
                               "MB.4015",
                               "MB.4046",
                               "MB.4091",
                               "MB.4098",
                               "MB.4120",
                               "MB.4139",
                               "MB.4171",
                               "MB.4212",
                               "MB.4222",
                               "MB.4234",
                               "MB.4235",
                               "MB.4266",
                               "MB.4278",
                               "MB.4306",
                               "MB.4333",
                               "MB.4343",
                               "MB.4375",
                               "MB.4408",
                               "MB.4417",
                               "MB.4442",
                               "MB.4630",
                               "MB.4643",
                               "MB.4648",
                               "MB.4653",
                               "MB.4661",
                               "MB.4665",
                               "MB.4670",
                               "MB.4672",
                               "MB.4679",
                               "MB.4681",
                               "MB.4682",
                               "MB.4691",
                               "MB.4692",
                               "MB.4697",
                               "MB.4704",
                               "MB.4705",
                               "MB.4708",
                               "MB.4712",
                               "MB.4717",
                               "MB.4722",
                               "MB.4730",
                               "MB.4735",
                               "MB.4738",
                               "MB.4743",
                               "MB.4749",
                               "MB.4770",
                               "MB.4778",
                               "MB.4782",
                               "MB.4787",
                               "MB.4790",
                               "MB.4791",
                               "MB.4796",
                               "MB.4800",
                               "MB.4802",
                               "MB.4809",
                               "MB.4814",
                               "MB.4822",
                               "MB.4825",
                               "MB.4839",
                               "MB.4853",
                               "MB.4858",
                               "MB.4866",
                               "MB.4867",
                               "MB.4871",
                               "MB.4878",
                               "MB.4880",
                               "MB.4882",
                               "MB.4894",
                               "MB.4896",
                               "MB.4897",
                               "MB.4933",
                               "MB.4937",
                               "MB.4949",
                               "MB.4970",
                               "MB.4987",
                               "MB.4992",
                               "MB.5035",
                               "MB.5049",
                               "MB.5053",
                               "MB.5054",
                               "MB.5057",
                               "MB.5059",
                               "MB.5064",
                               "MB.5081",
                               "MB.5084",
                               "MB.5086",
                               "MB.5098",
                               "MB.5119",
                               "MB.5150",
                               "MB.5154",
                               "MB.5169",
                               "MB.5174",
                               "MB.5184",
                               "MB.5196",
                               "MB.5206",
                               "MB.5208",
                               "MB.5221",
                               "MB.5239",
                               "MB.5275",
                               "MB.5277",
                               "MB.5278",
                               "MB.5279",
                               "MB.5280",
                               "MB.5290",
                               "MB.5292",
                               "MB.5306",
                               "MB.5324",
                               "MB.5331",
                               "MB.5335",
                               "MB.5351",
                               "MB.5393",
                               "MB.5402",
                               "MB.5422",
                               "MB.5424",
                               "MB.5429",
                               "MB.5470",
                               "MB.5471",
                               "MB.5489",
                               "MB.5490",
                               "MB.5491",
                               "MB.5499",
                               "MB.5511",
                               "MB.5563",
                               "MB.5634",
                               "MB.5640",
                               "MB.5656",
                               "MB.6008",
                               "MB.6011",
                               "MB.6012",
                               "MB.6014",
                               "MB.6016",
                               "MB.6018",
                               "MB.6019",
                               "MB.6021",
                               "MB.6023",
                               "MB.6024",
                               "MB.6026",
                               "MB.6042",
                               "MB.6044",
                               "MB.6049",
                               "MB.6050",
                               "MB.6060",
                               "MB.6068",
                               "MB.6075",
                               "MB.6077",
                               "MB.6092",
                               "MB.6101",
                               "MB.6105",
                               "MB.6116",
                               "MB.6131",
                               "MB.6133",
                               "MB.6149",
                               "MB.6150",
                               "MB.6152",
                               "MB.6154",
                               "MB.6156",
                               "MB.6168",
                               "MB.6169",
                               "MB.6178",
                               "MB.6179",
                               "MB.6183",
                               "MB.6185",
                               "MB.6207",
                               "MB.6211",
                               "MB.6218",
                               "MB.6225",
                               "MB.6229",
                               "MB.6231",
                               "MB.6234",
                               "MB.6237",
                               "MB.6238",
                               "MB.6245",
                               "MB.6271",
                               "MB.6286",
                               "MB.6314",
                               "MB.6318",
                               "MB.6344",
                               "MB.6358",
                               "MB.6359",
                               "MB.7055",
                               "MB.7150",
                               "MB.7186",
                               "MB.7231",
                               "MB.7232",
                               "MB.7241")]
write.table(METABRIC_pam50_surv, 
            "C:/Users/pkevi/Documents/Thesis/E.X.E/Scripts/tidy/exe.tidy/METABRIC_pam50_surv.txt",
            sep = "\t")


